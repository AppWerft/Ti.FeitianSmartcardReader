package gnu.kawa.functions;

import gnu.kawa.format.ReportFormat;
import gnu.kawa.io.OutPort;
import java.io.IOException;
import java.text.FieldPosition;
























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































class LispTabulateFormat
  extends ReportFormat
{
  boolean relative;
  int colnum;
  int colinc;
  int padChar;
  
  public LispTabulateFormat(int colnum, int colinc, int padChar, boolean relative)
  {
    this.colnum = colnum;
    this.colinc = colinc;
    this.relative = relative;
    this.padChar = padChar;
  }
  
  public int format(Object[] args, int start, Appendable dst, FieldPosition fpos)
    throws IOException
  {
    int colnum = getParam(this.colnum, 1, args, start);
    if (this.colnum == -1610612736) start++;
    int colinc = getParam(this.colinc, 1, args, start);
    if (this.colinc == -1610612736) { start++;
    }
    char padChar = getParam(this.padChar, ' ', args, start);
    if (this.padChar == -1610612736) start++;
    int column = -1;
    if ((dst instanceof OutPort))
      column = ((OutPort)dst).getColumnNumber();
    int spaces;
    int spaces; if (column >= 0) {
      int spaces;
      if (!relative) {
        int spaces;
        if (column < colnum) {
          spaces = colnum - column; } else { int spaces;
          if (colinc <= 0) {
            spaces = 0;
          } else {
            spaces = colinc - (column - colnum) % colinc;
          }
        }
      } else {
        spaces = colnum + colinc - (column + colnum) % colinc;
      }
    }
    else
    {
      spaces = relative ? colnum : 2;
    }
    for (;;) { spaces--; if (spaces < 0) break;
      dst.append(padChar); }
    return start;
  }
}
