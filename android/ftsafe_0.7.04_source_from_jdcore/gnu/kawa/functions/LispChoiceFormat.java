package gnu.kawa.functions;

import gnu.kawa.format.ReportFormat;
import java.io.IOException;
import java.text.FieldPosition;
import java.text.Format;




















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































class LispChoiceFormat
  extends ReportFormat
{
  int param;
  boolean lastIsDefault;
  boolean testBoolean;
  boolean skipIfFalse;
  Format[] choices;
  
  LispChoiceFormat() {}
  
  public int format(Object[] args, int start, Appendable dst, FieldPosition fpos)
    throws IOException
  {
    Format fmt;
    if (testBoolean)
    {
      Format fmt = choices[1];
      start++;
    } else { Format fmt;
      if (!skipIfFalse)
      {
        int index = getParam(param, -1610612736, args, start);
        
        if (param == -1610612736) start++;
        if ((index < 0) || (index >= choices.length))
        {
          if (lastIsDefault) {
            index = choices.length - 1;
          } else
            return start;
        }
        fmt = choices[index];
      }
      else
      {
        if (args[start] == Boolean.FALSE)
          return start + 1;
        fmt = choices[0];
      } }
    return ReportFormat.format(fmt, args, start, dst, fpos);
  }
}
